diff -uNrp zabbix-1.6.6.orig/build/win32/project/zabbix_agentd.vcproj zabbix-1.6.6/build/win32/project/zabbix_agentd.vcproj
--- zabbix-1.6.6.orig/build/win32/project/zabbix_agentd.vcproj	2009-08-26 22:16:26.000000000 +0900
+++ zabbix-1.6.6/build/win32/project/zabbix_agentd.vcproj	2009-11-04 17:03:22.000000000 +0900
@@ -140,7 +140,7 @@
 				AdditionalOptions="/Wp64 "
 				Optimization="0"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_agent"
-				PreprocessorDefinitions="_DEBUG;_WIN64;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
+				PreprocessorDefinitions="_DEBUG;_WIN64;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
 				RuntimeLibrary="1"
 				PrecompiledHeaderFile=".\Debug_AMD64/zabbix_agentd.pch"
 				AssemblerListingLocation=".\Debug_AMD64/"
@@ -233,7 +233,7 @@
 				Optimization="2"
 				InlineFunctionExpansion="1"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_agent"
-				PreprocessorDefinitions="NDEBUG;_WIN64;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
+				PreprocessorDefinitions="NDEBUG;_WIN64;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
 				StringPooling="true"
 				RuntimeLibrary="0"
 				EnableFunctionLevelLinking="true"
@@ -325,7 +325,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="0"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_agent"
-				PreprocessorDefinitions="_DEBUG;DEBUG;WIN32;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS;HAVE_IPV6"
+				PreprocessorDefinitions="_DEBUG;DEBUG;WIN32;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS;HAVE_IPV6"
 				MinimalRebuild="true"
 				BasicRuntimeChecks="3"
 				RuntimeLibrary="1"
@@ -419,7 +419,7 @@
 				Optimization="2"
 				InlineFunctionExpansion="1"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_agent"
-				PreprocessorDefinitions="NDEBUG;WIN32;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
+				PreprocessorDefinitions="NDEBUG;WIN32;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
 				StringPooling="true"
 				RuntimeLibrary="0"
 				EnableFunctionLevelLinking="true"
@@ -512,7 +512,7 @@
 				AdditionalOptions="/Wp64 "
 				Optimization="0"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_agent"
-				PreprocessorDefinitions="_DEBUG;_WIN64;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
+				PreprocessorDefinitions="_DEBUG;_WIN64;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
 				RuntimeLibrary="1"
 				PrecompiledHeaderFile=".\Debug_AMD64/zabbix_agentd.pch"
 				AssemblerListingLocation=".\Debug_AMD64/"
@@ -701,7 +701,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="0"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_agent"
-				PreprocessorDefinitions="_DEBUG;DEBUG;WIN32;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
+				PreprocessorDefinitions="_DEBUG;DEBUG;WIN32;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;ZABBIX_SERVICE;WITH_COMMON_METRICS;WITH_SPECIFIC_METRICS;WITH_SIMPLE_METRICS"
 				MinimalRebuild="true"
 				BasicRuntimeChecks="3"
 				RuntimeLibrary="1"
diff -uNrp zabbix-1.6.6.orig/build/win32/project/zabbix_sender.vcproj zabbix-1.6.6/build/win32/project/zabbix_sender.vcproj
--- zabbix-1.6.6.orig/build/win32/project/zabbix_sender.vcproj	2009-08-26 22:16:25.000000000 +0900
+++ zabbix-1.6.6/build/win32/project/zabbix_sender.vcproj	2009-11-04 17:03:58.000000000 +0900
@@ -139,7 +139,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="0"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_sender"
-				PreprocessorDefinitions="_DEBUG;WIN32;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;_WINDOWS"
+				PreprocessorDefinitions="_DEBUG;WIN32;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;_WINDOWS"
 				MinimalRebuild="true"
 				BasicRuntimeChecks="3"
 				RuntimeLibrary="1"
@@ -232,7 +232,7 @@
 				Optimization="2"
 				InlineFunctionExpansion="1"
 				AdditionalIncludeDirectories="./,../include/,../../../include/"
-				PreprocessorDefinitions="NDEBUG;WIN32;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE"
+				PreprocessorDefinitions="NDEBUG;WIN32;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE"
 				StringPooling="true"
 				RuntimeLibrary="0"
 				EnableFunctionLevelLinking="true"
@@ -324,7 +324,7 @@
 				Optimization="2"
 				InlineFunctionExpansion="1"
 				AdditionalIncludeDirectories="./,../include/,../../../include/"
-				PreprocessorDefinitions="_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;WIN32;NDEBUG;_CONSOLE"
+				PreprocessorDefinitions="_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;WIN32;NDEBUG;_CONSOLE"
 				StringPooling="true"
 				RuntimeLibrary="0"
 				EnableFunctionLevelLinking="true"
@@ -416,7 +416,7 @@
 				Name="VCCLCompilerTool"
 				Optimization="0"
 				AdditionalIncludeDirectories="./,../include/,../../../include/,../../../src/zabbix_sender"
-				PreprocessorDefinitions="_DEBUG;WIN32;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE;_WINDOWS"
+				PreprocessorDefinitions="_DEBUG;WIN32;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE;_WINDOWS"
 				MinimalRebuild="true"
 				BasicRuntimeChecks="3"
 				RuntimeLibrary="1"
@@ -511,7 +511,7 @@
 				Optimization="2"
 				InlineFunctionExpansion="1"
 				AdditionalIncludeDirectories="./,../include/,../../../include/"
-				PreprocessorDefinitions="NDEBUG;_WIN64;_WINDOWS;HAVE_LDAP;HAVE_ASSERT_H;_CONSOLE"
+				PreprocessorDefinitions="NDEBUG;_WIN64;_WINDOWS;HAVE_WINLDAP_H;HAVE_ASSERT_H;_CONSOLE"
 				StringPooling="true"
 				RuntimeLibrary="0"
 				EnableFunctionLevelLinking="true"
